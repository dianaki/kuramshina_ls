(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{100:function(e,t,r){},105:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-component"},[r("avatar",{attrs:{size:e.size,src:e.userPic}}),e._v(" "),r("div",{staticClass:"userdata"},[r("div",{staticClass:"username"},[e._v(e._s(e.name))]),e._v(" "),r("div",{staticClass:"occ"},[e._v(e._s(e.occ))])])],1)};i._withStripped=!0;var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"avatar-component",style:this.measures},[t("img",this._b({staticClass:"image",attrs:{alt:"user picture"}},"img",this.$attrs,!1))])};n._withStripped=!0;var o={props:{size:{type:Number,default:"3"}},computed:{measures:function(){var e=Number(this.size);return{width:"".concat(e,"rem"),height:"".concat(e,"rem")}}}},s=(r(86),r(18)),a=Object(s.a)(o,n,[],!1,null,"3142f16f",null);a.options.__file="src/admin/components/avatar/avatar.vue";var c=a.exports,u={props:{size:{type:Number,default:2.7},occ:String,name:String,photo:String},components:{avatar:c},computed:{userPic:function(){return this.photo?"https://webdev-api.loftschool.com/".concat(this.photo):r(87).default}}},l=(r(88),Object(s.a)(u,i,[],!1,null,null,null));l.options.__file="src/admin/components/user/user.vue";var v=l.exports},123:function(e,t,r){"use strict";var i=r(98);r.n(i).a},124:function(e,t,r){"use strict";var i=r(99);r.n(i).a},125:function(e,t,r){"use strict";var i=r(100);r.n(i).a},133:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return $}));var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reviews-page-comp page-component"},[r("div",{staticClass:"page-content"},[r("div",{staticClass:"container"},[e._m(0),e._v(" "),e.formIsShown||0!==Object.keys(this.currentReview).length?r("div",{staticClass:"form"},[r("app-form",{attrs:{currentReview:e.currentReview,"form-title":e.formTitle,"edit-review-data":e.currentReview},on:{"reset-handler":e.resetHandler}})],1):e._e(),e._v(" "),r("ul",{staticClass:"cards"},[r("li",{staticClass:"item"},[r("square-btn",{attrs:{type:"square",title:"Добавить отзыв"},on:{click:e.shownForm}})],1),e._v(" "),e._l(e.reviews,(function(t){return r("li",{key:t.id,class:["item",{"edit-review":e.isCurrentReview(t)}]},[r("review-card",{attrs:{review:t},on:{"edit-review":function(r){return e.editReview(t)}}})],1)}))],2)])])])};i._withStripped=!0;var n=r(19),o=r.n(n),s=r(69),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-component"},[r("form",{staticClass:"form",on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("card",{attrs:{title:e.formTitle}},[r("div",{staticClass:"form-container",attrs:{slot:"content"},slot:"content"},[r("div",{staticClass:"form-cols"},[r("div",{staticClass:"form-col"},[r("label",[r("div",{class:["uploader",{active:e.preview},{hovered:e.hovered}],style:{backgroundImage:"url("+e.preview+")"},on:{dragover:e.handleDragOver,dragleave:function(t){e.hovered=!1},drop:e.handleChange}},[""===e.preview?r("div",{staticClass:"uploader-user-icon"}):e._e()]),e._v(" "),r("div",{staticClass:"uploader-btn"},[r("app-button",{attrs:{plain:"",title:"Добавить фото",typeAttr:"file",errorMessage:e.validation.firstError("newReview.photo")},on:{change:e.handleChange},model:{value:e.newReview.photo,callback:function(t){e.$set(e.newReview,"photo",t)},expression:"newReview.photo"}})],1)])]),e._v(" "),r("div",{staticClass:"form-col from-col-text"},[r("div",{staticClass:"form-row"},[r("app-input",{attrs:{title:"Имя автора",errorMessage:e.validation.firstError("newReview.author")},model:{value:e.newReview.author,callback:function(t){e.$set(e.newReview,"author",t)},expression:"newReview.author"}}),e._v(" "),r("app-input",{attrs:{title:"Титул автора",errorMessage:e.validation.firstError("newReview.occ")},model:{value:e.newReview.occ,callback:function(t){e.$set(e.newReview,"occ",t)},expression:"newReview.occ"}})],1),e._v(" "),r("div",{staticClass:"form-row"},[r("app-input",{attrs:{"field-type":"textarea",title:"Отзыв",errorMessage:e.validation.firstError("newReview.text")},model:{value:e.newReview.text,callback:function(t){e.$set(e.newReview,"text",t)},expression:"newReview.text"}})],1)])]),e._v(" "),r("div",{staticClass:"form-btns"},[r("div",{staticClass:"btn"},[r("app-button",{attrs:{title:"Отмена",plain:""},on:{click:function(t){return t.preventDefault(),e.$emit("reset-handler")}}})],1),e._v(" "),r("div",{staticClass:"btn"},[r("app-button",{attrs:{title:"Сохранить",typeAttr:"submit"}})],1)])])])],1)])};a._withStripped=!0;var c=r(0),u=r.n(c),l=r(1),v=r.n(l),p=r(75),w=r(74),f=r(6),d=r(23);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b={mixins:[d.mixin],validators:{"newReview.author":function(e){return d.Validator.value(e).required("Заполните поле")},"newReview.occ":function(e){return d.Validator.value(e).required("Заполните поле")},"newReview.text":function(e){return d.Validator.value(e).required("Заполните поле")},"newReview.photo":function(e){return d.Validator.value(e).required("Вставьте файл")}},components:{card:p.a,appButton:s.a,appInput:w.default,Validator:d.Validator},props:{formTitle:String,currentReview:{type:Object,default:function(){return{}}}},data:function(){return{hovered:!1,preview:"",newReview:{author:"",occ:"",text:"",photo:{}}}},watch:{currentReview:function(){Object.keys(this.currentReview).length&&(this.newReview=m({},this.currentReview),this.preview="https://webdev-api.loftschool.com/".concat(this.currentReview.photo))}},created:function(){Object.keys(this.currentReview).length&&(this.newReview=m({},this.currentReview),this.preview="https://webdev-api.loftschool.com/".concat(this.currentReview.photo))},methods:m(m({},Object(f.b)({addNewReviewAction:"reviews/add",editReviewAction:"reviews/edit",showTooltip:"tooltips/show"})),{},{handleDragOver:function(e){e.preventDefault(),this.hovered=!0},handleSubmit:function(){var e=this;return v()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:if(e.$emit("reset-handler"),!e.newReview.id){t.next=12;break}return t.next=9,e.editReviewAction(e.newReview);case 9:try{e.showTooltip({type:"success",text:"Отзыв изменен"})}catch(t){e.showTooltip({type:"error",text:t.mesage})}t.next=15;break;case 12:return t.next=14,e.addNewReviewAction(e.newReview);case 14:try{e.showTooltip({type:"success",text:"Отзыв добавлен"})}catch(t){e.showTooltip({type:"error",text:t.mesage})}case 15:case"end":return t.stop()}}),t)})))()},handleChange:function(e){e.preventDefault();var t=e.dataTransfer?e.dataTransfer.files[0]:e.target.files[0];this.newReview.photo=t,this.renderPhoto(t),this.hovered=!1},renderPhoto:function(e){var t=this,r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t.preview=r.result}}})},O=(r(123),r(18)),R=Object(O.a)(b,a,[],!1,null,"31c69ce2",null);R.options.__file="src/admin/components/reviewsForm/reviewsForm.vue";var y=R.exports,g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("card",[r("div",{staticClass:"author",attrs:{slot:"title"},slot:"title"},[r("user",{attrs:{size:3,photo:e.review.photo,name:e.review.author,occ:e.review.occ}})],1),e._v(" "),r("div",{staticClass:"data",attrs:{slot:"content"},slot:"content"},[r("div",{staticClass:"text"},[r("p",[e._v(e._s(e.review.text))])]),e._v(" "),r("div",{staticClass:"btns"},[r("icon",{attrs:{symbol:"pencil",title:"Править"},on:{click:function(t){return e.$emit("edit-review")}}}),e._v(" "),r("icon",{attrs:{symbol:"trash",title:"Удалить"},on:{click:e.removeReview}})],1)])])};g._withStripped=!0;var _=r(76),j=r(105);function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P={components:{card:p.a,icon:_.default,user:j.a},props:{review:Object},computed:{cover:function(){return"https://webdev-api.loftschool.com/".concat(this.review.photo)}},methods:x(x({},Object(f.b)({removeReviewAction:"reviews/remove",showTooltip:"tooltips/show"})),{},{removeReview:function(){var e=this;return v()(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.removeReviewAction(e.review.id);case 3:e.showTooltip({type:"success",text:"Отзыв удален"}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.showTooltip({type:"error",text:t.t0.mesage});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()}})},k=(r(124),Object(O.a)(P,g,[],!1,null,"7b932b0f",null));function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}k.options.__file="src/admin/components/reviewCard/reviewCard.vue";var E={components:{appForm:y,reviewCard:k.exports,squareBtn:s.a},data:function(){return{currentReview:{},formIsShown:!1,formTitle:"Новый отзыв"}},computed:D({},Object(f.c)("reviews",{reviews:function(e){return e.data}})),methods:D(D({},Object(f.b)({fetchReviews:"reviews/fetch"})),{},{shownForm:function(){this.formIsShown=!this.formIsShown},resetHandler:function(){this.formIsShown=!1,this.currentReview={},this.formTitle="Новый отзыв"},editReview:function(e){this.formTitle="Редактирование отзыва",this.currentReview=e},isCurrentReview:function(e){return e.id===this.currentReview.id}}),mounted:function(){this.fetchReviews()}},T=(r(125),Object(O.a)(E,i,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"title"},[this._v('\n          Блок "Отзывы"\n        ')])])}],!1,null,"2c7c3bd3",null));T.options.__file="src/admin/pages/reviews/reviews.vue";var $=T.exports},71:function(e,t,r){},72:function(e,t,r){},86:function(e,t,r){"use strict";var i=r(71);r.n(i).a},87:function(e,t,r){"use strict";r.r(t),t.default=r.p+"9c757ab7290c30bafb3fd4ca95a53805.png"},88:function(e,t,r){"use strict";var i=r(72);r.n(i).a},98:function(e,t,r){},99:function(e,t,r){}}]);